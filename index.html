<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Random Cards</title>
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  <label>
    <input type="text" id="search-bar" placeholder="Search...">
  </label>
  <button id="generate-btn">Generate Random </button>
  <div id="phone-container">
  </div>
  <script>
   
let allProducts;

// Function to get 10 random phones from the API and display them
async function getRandomPhones() {
  const response = await fetch("https://dummyjson.com/products");
  const data = await response.json();

 
  allProducts = data.products;

 
  const phoneCount = 10;
  const randomPhones = [];
  for (let i = 0; i < phoneCount; i++) {
    const phoneIndex = Math.floor(Math.random() * allProducts.length);
    const phone = allProducts[phoneIndex];
    randomPhones.push(phone);
  }


  displayPhones(randomPhones);
  flipAllCards();
}

// Function to display the phones on the page
function displayPhones(phones) {
  const container = document.getElementById("phone-container");
  container.innerHTML = "";
  for (let i = 0; i < phones.length; i++) {
    const phone = phones[i];
    const card = document.createElement("div");
    card.classList.add("phone-card");
    card.innerHTML = `
      <div class="card-front">
      
        
        <img src="${phone.images[0]}" alt="${phone.title}">

        <h3>${phone.title}</h3>
        <p>${phone.description}</p>
        <ul>
          <li>Brand: ${phone.brand}</li>
          <li>Category: ${phone.category}</li>
          <li>Price: ${phone.price}</li>
          <li>Discount: ${phone.discount}</li>
          <li>Rating: ${phone.rating}</li>
        </ul>
        <button onclick="showImages('${phone.id}')">View Images</button>
      </div>
      <div class="card-back">
        <p></p>
      </div>
    `;
    container.appendChild(card);
  }
}

// Function to flip all cards on the page
function flipAllCards() {
  const cards = document.querySelectorAll(".phone-card");
  for (let i = 0; i < cards.length; i++) {
    const card = cards[i];
    card.classList.add("flipped");
    setTimeout(function () {
      card.classList.remove("flipped");
    }, 600);
  }
}

// Function to filter products based on search term

function filterProducts(searchTerm) {
  if (searchTerm === '') {
    getRandomPhones();
    return;
  }
  const filteredProducts = allProducts.filter(function (product) {
    const title = product.title.toLowerCase();
    const description = product.description.toLowerCase();
    return title.includes(searchTerm) || description.includes(searchTerm);
  });
  displayPhones(filteredProducts);
}


// Function to show all images of a product
async function showImages(productId) {
  const product = await getProductById(productId);
  if (!product) {
    console.log(`Product with ID ${productId} not found`);
    return;
  }
  const modal = document.createElement("div");
  modal.classList.add("modal");
  const modalContent = document.createElement("div");
  modalContent.classList.add("modal-content");
  const closeButton = document.createElement("span");
  closeButton.classList.add("close");
  closeButton.innerHTML = "&times;";
  closeButton.addEventListener("click", function () {
    modal.remove();
  });
  modalContent.appendChild(closeButton);
  for (let i = 0; i < product.images.length; i++) {
    const image = product.images[i];
    const imgElement = document.createElement("img");
    imgElement.setAttribute("src", image);
    modalContent.appendChild(imgElement);
  }
  modal.appendChild(modalContent);
  document.body.appendChild(modal);
}

// Function to get a product by ID from the API
async function getProductById(productId) {
  const response = await fetch("./products.json");
  const data = await response.json();
  const product = data.products.find(function (item) {
    return item.id === productId;
  });
  return product;
}

// Event listener for search bar input
const searchInput = document.getElementById("search-bar");
searchInput.addEventListener("input", function () {
  const searchTerm = searchInput.value.toLowerCase();
  filterProducts(searchTerm);
});

// Event listener for "Generate Random Phones" button
const generateBtn = document.getElementById("generate-btn");
generateBtn.addEventListener("click", getRandomPhones);

window.onload = function() {
  getRandomPhones();
}

  </script>
</body>
</html>
